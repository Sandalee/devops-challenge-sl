FROM node:lts-alpine

COPY package.json /app
COPY yarn.lock /app
WORKDIR /app
RUN yarn install

COPY ./ ./

#question 2
RUN groupadd -r user && useradd -r -g user user
USER user
CMD yarn start

#1. need to change the sequence, the source in that COPY command is the entire repo. 
#Changing anything in the repo therefore invalidates nearly every layer generated by the Dockerfile.
#If we could sequence COPYing the directory after RUNning the yarn install 
#we would be freer to alter the application code without incurring the penalty of reRUNning the yarn install step. 
#yarn install requires exactly two files: package.json and yarn.lock
#so we only need to COPY those two files before the RUNning the yarn install step. 
#We still need nearly the entire source directory before we can run the yarn start step

#2 edit the dockerfile to create a new group called user and a new user inside the group with the same name. 
#Using the USER option, user can be switched

